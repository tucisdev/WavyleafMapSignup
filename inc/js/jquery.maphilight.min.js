!function(t){var e,a,o,r,s,h,n,l,d,p,c;if(a=!!document.createElement("canvas").getContext,e=function(){var t=document.createElement("div");t.innerHTML='<v:shape id="vml_flag1" adj="1" />';var i=t.firstChild;return i.style.behavior="url(#default#VML)",i?"object"==typeof i.adj:!0}(),!a&&!e)return void(t.fn.maphilight=function(){return this});if(a){l=function(t){return Math.max(0,Math.min(parseInt(t,16),255))},d=function(t,i){return"rgba("+l(t.substr(0,2))+","+l(t.substr(2,2))+","+l(t.substr(4,2))+","+i+")"},o=function(i){var e=t('<canvas style="width:'+t(i).width()+"px;height:"+t(i).height()+'px;"></canvas>').get(0);return e.getContext("2d").clearRect(0,0,t(i).width(),t(i).height()),e};var f=function(t,e,a,o,r){if(o=o||0,r=r||0,t.beginPath(),"rect"==e)t.rect(a[0]+o,a[1]+r,a[2]-a[0],a[3]-a[1]);else if("poly"==e)for(t.moveTo(a[0]+o,a[1]+r),i=2;i<a.length;i+=2)t.lineTo(a[i]+o,a[i+1]+r);else"circ"==e&&t.arc(a[0]+o,a[1]+r,a[2],0,2*Math.PI,!1);t.closePath()};r=function(i,e,a,o){var r=i.getContext("2d");if(o.shadow){r.save(),"inside"==o.shadowPosition&&(f(r,e,a),r.clip());var s=100*i.width,h=100*i.height;f(r,e,a,s,h),r.shadowOffsetX=o.shadowX-s,r.shadowOffsetY=o.shadowY-h,r.shadowBlur=o.shadowRadius,r.shadowColor=d(o.shadowColor,o.shadowOpacity);var n=o.shadowFrom;n||(n="outside"==o.shadowPosition?"fill":"stroke"),"stroke"==n?(r.strokeStyle="rgba(0,0,0,1)",r.stroke()):"fill"==n&&(r.fillStyle="rgba(0,0,0,1)",r.fill()),r.restore(),"outside"==o.shadowPosition&&(r.save(),f(r,e,a),r.globalCompositeOperation="destination-out",r.fillStyle="rgba(0,0,0,1);",r.fill(),r.restore())}r.save(),f(r,e,a),o.fill&&(r.fillStyle=d(o.fillColor,o.fillOpacity),r.fill()),o.stroke&&(r.strokeStyle=d(o.strokeColor,o.strokeOpacity),r.lineWidth=o.strokeWidth,r.stroke()),r.restore(),o.fade&&t(i).css("opacity",0).animate({opacity:1},100)},s=function(t){t.getContext("2d").clearRect(0,0,t.width,t.height)}}else o=function(i){return t('<var style="zoom:1;overflow:hidden;display:block;width:'+i.width+"px;height:"+i.height+'px;"></var>').get(0)},r=function(i,e,a,o,r){var s,h,n,l;for(var d in a)a[d]=parseInt(a[d],10);s='<v:fill color="#'+o.fillColor+'" opacity="'+(o.fill?o.fillOpacity:0)+'" />',h=o.stroke?'strokeweight="'+o.strokeWidth+'" stroked="t" strokecolor="#'+o.strokeColor+'"':'stroked="f"',n='<v:stroke opacity="'+o.strokeOpacity+'"/>',"rect"==e?l=t('<v:rect name="'+r+'" filled="t" '+h+' style="zoom:1;margin:0;padding:0;display:block;position:absolute;left:'+a[0]+"px;top:"+a[1]+"px;width:"+(a[2]-a[0])+"px;height:"+(a[3]-a[1])+'px;"></v:rect>'):"poly"==e?l=t('<v:shape name="'+r+'" filled="t" '+h+' coordorigin="0,0" coordsize="'+i.width+","+i.height+'" path="m '+a[0]+","+a[1]+" l "+a.join(",")+' x e" style="zoom:1;margin:0;padding:0;display:block;position:absolute;top:0px;left:0px;width:'+i.width+"px;height:"+i.height+'px;"></v:shape>'):"circ"==e&&(l=t('<v:oval name="'+r+'" filled="t" '+h+' style="zoom:1;margin:0;padding:0;display:block;position:absolute;left:'+(a[0]-a[2])+"px;top:"+(a[1]-a[2])+"px;width:"+2*a[2]+"px;height:"+2*a[2]+'px;"></v:oval>')),l.get(0).innerHTML=s+n,t(i).append(l)},s=function(i){var e=t("<div>"+i.innerHTML+"</div>");e.children("[name=highlighted]").remove(),i.innerHTML=e.html()};h=function(t){var i,e=t.getAttribute("coords").split(",");for(i=0;i<e.length;i++)e[i]=parseFloat(e[i]);return[t.getAttribute("shape").toLowerCase().substr(0,4),e]},c=function(i,e){var a=t(i);return t.extend({},e,t.metadata?a.metadata():!1,a.data("maphilight"))},p=function(t){return t.complete?"undefined"!=typeof t.naturalWidth&&0===t.naturalWidth?!1:!0:!1},n={position:"absolute",left:0,top:0,padding:0,border:0};var u=!1;t.fn.maphilight=function(i){return i=t.extend({},t.fn.maphilight.defaults,i),a||u||(t(window).ready(function(){document.namespaces.add("v","urn:schemas-microsoft-com:vml");var i=document.createStyleSheet(),e=["shape","rect","oval","circ","fill","stroke","imagedata","group","textbox"];t.each(e,function(){i.addRule("v\\:"+this,"behavior: url(#default#VML); antialias:true")})}),u=!0),this.each(function(){var l,d,f,u,g,v,m,w;if(l=t(this),!p(this))return window.setTimeout(function(){l.maphilight(i)},200);if(f=t.extend({},i,t.metadata?l.metadata():!1,l.data("maphilight")),w=l.get(0).getAttribute("usemap"),w&&(u=t('map[name="'+w.substr(1)+'"]'),l.is('img,input[type="image"]')&&w&&u.size()>0)){if(l.hasClass("maphilighted")){var y=l.parent();l.insertBefore(y),y.remove(),t(u).unbind(".maphilight").find("area[coords]").unbind(".maphilight")}d=t("<div></div>").css({display:"block",backgroundImage:'url("'+this.src+'")',position:"relative",padding:0,width:this.width,height:this.height}),f.wrapClass&&d.addClass(f.wrapClass===!0?t(this).attr("class"):f.wrapClass),l.before(d).css("opacity",0).css(n).remove(),e&&l.css("filter","Alpha(opacity=0)"),d.append(l),g=o(this),t(g).css(n),g.height=this.height,g.width=this.width,m=function(){var i,e;if(e=c(this,f),!e.neverOn&&!e.alwaysOn){if(i=h(this),r(g,i[0],i[1],e,"highlighted"),e.groupBy){var o;o=u.find(/^[a-zA-Z][\-a-zA-Z]+$/.test(e.groupBy)?"area["+e.groupBy+'="'+t(this).attr(e.groupBy)+'"]':e.groupBy);var s=this;o.each(function(){if(this!=s){var t=c(this,f);if(!t.neverOn&&!t.alwaysOn){var i=h(this);r(g,i[0],i[1],t,"highlighted")}}})}a||t(g).append("<v:rect></v:rect>")}},t(u).bind("alwaysOn.maphilight",function(){v&&s(v),a||t(g).empty(),t(u).find("area[coords]").each(function(){var i,e;e=c(this,f),e.alwaysOn&&(!v&&a&&(v=o(l[0]),t(v).css(n),v.width=l[0].width,v.height=l[0].height,l.before(v)),e.fade=e.alwaysOnFade,i=h(this),a?r(v,i[0],i[1],e,""):r(g,i[0],i[1],e,""))})}),t(u).trigger("alwaysOn.maphilight").find("area[coords]").bind("mouseover.maphilight",m).bind("mouseout.maphilight",function(){s(g)}),l.before(g),l.addClass("maphilighted")}})},t.fn.maphilight.defaults={fill:!0,fillColor:"000000",fillOpacity:.2,stroke:!0,strokeColor:"ff0000",strokeOpacity:1,strokeWidth:1,fade:!0,alwaysOn:!1,neverOn:!1,groupBy:!1,wrapClass:!0,shadow:!1,shadowX:0,shadowY:0,shadowRadius:6,shadowColor:"000000",shadowOpacity:.8,shadowPosition:"outside",shadowFrom:!1}}(jQuery);